webpackJsonp([1],{0:function(t,e){},"4+hh":function(t,e){},CBWf:function(t,e){},Ktzi:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n("7+uW"),o=n("xvGj"),r={name:"App",data:function(){return{bottomPosition:"md-bottom-left"}},methods:{addModel:function(){console.log("Add model"),this.$router.push("/add")}},components:{CookieLaw:n.n(o).a}},i={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[t._m(0),t._v(" "),n("cookie-law",[n("div",{attrs:{slot:"message"},slot:"message"},[t._v("\n      This site uses cookies to match your transcripts.\n    ")])]),t._v(" "),n("router-view",{staticClass:"main"}),t._v(" "),n("md-speed-dial",{class:t.bottomPosition},[n("md-speed-dial-target",{on:{click:t.addModel}},[n("md-icon",[t._v("add")])],1)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"header"},[e("h1",[this._v("SONOSCO")]),this._v(" "),e("img",{staticStyle:{margin:"10px"},attrs:{src:n("WZbx"),width:"100",align:"right"}})])}]};var a=n("VU/8")(r,i,!1,function(t){n("CBWf")},null,null).exports,c=n("/ocq"),d=n("Xxa5"),u=n.n(d),l=n("exGp"),m=n.n(l),p=n("//Fk"),f=n.n(p),v={name:"Model",props:["name","model_id"],data:function(){return{isConnected:!1,socketMessage:"This is a transcription.",recordButtonText:"Record"}},sockets:{connect:function(){this.isConnected=!0},disconnect:function(){this.isConnected=!1},transcription:function(t){var e=t[this.model_id];if(Array.isArray(e)){if(1===e.length)return void(this.socketMessage=e[0]);for(var n="<ol>",s=0;s<e.length;s++)n+="<li>"+e[s]+"</li>";n+="</ol>",this.socketMessage=n}else this.socketMessage=e}},methods:{removeMyself:function(){this.$store.commit("removeModel",this.model_id)}}},h={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("md-card",{attrs:{"md-with-hover":""}},[n("md-card-header",[n("div",{staticClass:"md-title"},[t._v("\n      "+t._s(t.name)+"\n    ")])]),t._v(" "),n("md-card-content",{domProps:{innerHTML:t._s(t.socketMessage)}}),t._v(" "),n("md-card-actions",[n("md-button",{on:{click:function(e){return t.removeMyself()}}},[t._v("Close")])],1)],1)},staticRenderFns:[]};var _=this,b=null,k=null,g=function(){return new f.a((t=m()(u.a.mark(function t(e){var n,s;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.mediaDevices.getUserMedia({audio:!0});case 2:n=t.sent,s=new MediaRecorder(n,{mimeType:"audio/webm; codecs=opus"}),b=[],s.addEventListener("dataavailable",function(t){b.push(t.data)}),e({start:function(){return s.start()},stop:function(){return new f.a(function(t){s.addEventListener("stop",function(){k=new Blob(b,{type:"audio/wav;"});var e=URL.createObjectURL(k),n=new Audio(e);t({audioBlob:k,audioUrl:e,play:function(){return n.play()}})}),s.stop()})}});case 9:case"end":return t.stop()}},t,_)})),function(e){return t.apply(this,arguments)}));var t},C=null,M=null,w={name:"Transcriptor",components:{model:n("VU/8")(v,h,!1,function(t){n("VITB")},"data-v-72eae6fe",null).exports},data:function(){return{userId:"",popupVisible:!1,isConnected:!1,editableTranscript:"",socketMessage:"",recordButtonText:"Record"}},sockets:{connect:function(){this.isConnected=!0},disconnect:function(){this.isConnected=!1},transcription:function(t){this.socketMessage=t,this.popupVisible=!0;var e=t[this.$store.getters.getPickedModels.map(function(t){return t.id})[0]];Array.isArray(e)?this.editableTranscript=e[0]:this.editableTranscript=e}},methods:{checkCookies:function(){this.$cookies.isKey("userID")?this.userId=window.$cookies.get("userID"):(this.userId=Math.random().toString(36).substring(2)+Date.now().toString(36),this.$cookies.set("userID",String(this.userId),1e3))},cancel:function(){this.popupVisible=!1,this.editableTranscript=""},saveTranscript:function(){var t=this;return m()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.checkCookies(),t.$socket.emit("saveSample",k,t.editableTranscript,t.userId),console.log("Transcript to be saved: ",t.editableTranscript),t.popupVisible=!1;case 4:case"end":return e.stop()}},e,t)}))()},recordStop:function(){var t=this;return m()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!C){e.next=10;break}return e.next=3,C.stop();case 3:M=e.sent,C=null,t.socketMessage="",t.editableTranscript="",t.recordButtonText="Record",e.next=15;break;case 10:return e.next=12,g();case 12:(C=e.sent).start(),t.recordButtonText="Stop";case 15:case"end":return e.stop()}},e,t)}))()},playAudio:function(){var t=this;return m()(u.a.mark(function e(){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:M&&"function"==typeof M.play&&M.play();case 1:case"end":return t.stop()}},e,t)}))()},transcribe:function(){var t=this;return m()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:M&&"function"==typeof M.play&&t.$socket.emit("transcribe",k,t.$store.getters.getPickedModels.map(function(t){return t.id}));case 1:case"end":return e.stop()}},e,t)}))()}}},y={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"Transcriptor"},[t.isConnected?n("h3",[t._v("Ready to transcribe!")]):t._e(),t._v(" "),n("div",{staticClass:"md-layout"},[n("div",{staticClass:"md-layout"},t._l(this.$store.state.models,function(t){return n("model",{key:t.id,staticClass:"md-layout-item",attrs:{model_id:t.id,name:t.name}})}),1),t._v(" "),t.popupVisible?n("div",{staticClass:"popup",attrs:{id:"popup"}},[n("md-card",[n("md-card-header",[n("div",{staticClass:"md-title"},[t._v("Help us improve our model!")])]),t._v(" "),n("md-card-content",[t._v("\n          Please enter the correct transcription."),n("br")]),t._v(" "),n("md-card-content",[n("md-field",[n("md-textarea",{model:{value:t.editableTranscript,callback:function(e){t.editableTranscript=e},expression:"editableTranscript"}}),t._v(" "),n("span",{staticClass:"md-error"},[t._v("There is an error")])],1)],1),t._v(" "),n("div",{staticStyle:{"margin-bottom":"2px"},attrs:{align:"center"}},[n("md-button",{staticClass:"md-raised md-primary",on:{click:function(e){return t.saveTranscript()}}},[t._v("Improve!")]),t._v(" "),n("md-button",{staticClass:"md-raised md-accent",on:{click:function(e){return t.cancel()}}},[t._v("I don't want to help")])],1)],1)],1):t._e()]),t._v(" "),n("div",{staticClass:"controls"},[n("md-button",{staticClass:"md-raised",on:{click:function(e){return t.recordStop()}}},[t._v(t._s(t.recordButtonText))]),t._v(" "),n("md-button",{staticClass:"md-raised",on:{click:function(e){return t.playAudio()}}},[t._v("Play")]),t._v(" "),n("md-button",{staticClass:"md-raised",on:{click:function(e){return t.transcribe()}}},[t._v("Transcribe")])],1)])},staticRenderFns:[]};var x=n("VU/8")(w,y,!1,function(t){n("Ktzi")},"data-v-c53e5dda",null).exports,T=n("mtWM"),S=n.n(T),$={name:"ModelSelector",data:function(){return{models:null,chosenModel:null}},mounted:function(){var t=this;S.a.get(H+"/get_models").then(function(e){console.log("Models received from server: ",e.data),t.models=e.data,t.chosenModel=e.data[0]}).catch(function(t){console.log("ERROR IN AXIOS",t)})},sockets:{connect:function(){this.isConnected=!0},disconnect:function(){this.isConnected=!1},transcription:function(t){this.socketMessage=t}},methods:{add:function(t){this.$store.commit("addModel",{id:t,name:this.models[t]}),this.$router.push("/")},cancel:function(){this.$router.push("/")}}},I={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ModelSelector"},[n("md-field",{staticClass:"select"},[n("label",{attrs:{for:"model"}},[t._v("ModelSelector")]),t._v(" "),n("md-select",{attrs:{id:"model"},model:{value:t.chosenModel,callback:function(e){t.chosenModel=e},expression:"chosenModel"}},t._l(t.models,function(e,s,o){return n("md-option",{key:s,attrs:{value:s}},[t._v("\n              "+t._s(e)+"\n            ")])}),1)],1),t._v(" "),n("div",{staticClass:"controls"},[n("md-button",{staticClass:"md-raised md-primary",on:{click:function(e){return t.add(t.chosenModel)}}},[t._v("Add")]),t._v(" "),n("md-button",{staticClass:"md-raised md-accent",on:{click:t.cancel}},[t._v("Cancel")])],1)],1)},staticRenderFns:[]};var V=n("VU/8")($,I,!1,function(t){n("qflV")},"data-v-b75c546c",null).exports;s.default.use(c.a);var R=new c.a({routes:[{path:"/",name:"Transcriptor",component:x},{path:"/add",name:"ModelSelector",component:V}]}),A=n("NYxO"),U=(n("UjVw"),n("mUbh"));s.default.use(A.a);var B=new A.a.Store({state:{models:[]},getters:{getPickedModels:function(t){return t.models}},actions:U,mutations:{addModel:function(t,e){t.models.push(e)},removeModel:function(t,e){for(var n=0;n<t.models.length&&this.state.models[n].id!==e;n++);n!==t.models.length&&t.models.splice(n,1)}}}),P=n("DmT9"),D=n.n(P),E=n("HI0L"),L=n.n(E),O=n("Lgyv"),j=n.n(O),W=n("ppUw"),F=n.n(W);n("4+hh"),n("giDI");n.d(e,"ServerAddress",function(){return H}),n.d(e,"SocketInstance",function(){return N}),s.default.config.productionTip=!1;var H="http//35.207.75.234:5000",N=D()(H);s.default.use(j.a),s.default.use(F.a),s.default.use(new L.a({debug:!0,connection:N})),new s.default({router:R,store:B,render:function(t){return t(a)},components:{App:a}}).$mount("#app")},UjVw:function(t,e){},VITB:function(t,e){},WZbx:function(t,e,n){t.exports=n.p+"static/img/roboy.f1292fa.jpg"},giDI:function(t,e){},mUbh:function(t,e){},qflV:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.3df7e73e421776546177.js.map