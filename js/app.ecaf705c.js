(function(e){function t(t){for(var o,a,c=t[0],i=t[1],d=t[2],u=0,p=[];u<c.length;u++)a=c[u],s[a]&&p.push(s[a][0]),s[a]=0;for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o]);l&&l(t);while(p.length)p.shift()();return r.push.apply(r,d||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,c=1;c<n.length;c++){var i=n[c];0!==s[i]&&(o=!1)}o&&(r.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},s={app:0},r=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var d=0;d<c.length;d++)t(c[d]);var l=i;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var o=n("13bb"),s=n.n(o);s.a},1:function(e,t){},"13bb":function(e,t,n){},"1ef5":function(e,t,n){e.exports=n.p+"f1292fa3928a60ca62207167060d2bcb.jpg"},"46d4":function(e,t,n){"use strict";var o=n("4eaa"),s=n.n(o);s.a},"4eaa":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);var o=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e._m(0),n("router-view",{staticClass:"main"}),n("md-speed-dial",{class:e.bottomPosition},[n("md-speed-dial-target",{on:{click:e.addModel}},[n("md-icon",[e._v("add")])],1)],1)],1)},r=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"header"},[o("h1",[e._v("SONOSCO")]),o("img",{staticStyle:{margin:"10px"},attrs:{src:n("1ef5"),width:"100",align:"right"}})])}],a={name:"App",data:()=>({bottomPosition:"md-bottom-left"}),methods:{addModel(){console.log("Add model"),this.$router.push("/add")}}},c=a,i=(n("034f"),n("2877")),d=Object(i["a"])(c,s,r,!1,null,null,null),l=d.exports,u=n("8c4f"),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"Transcriptor"},[e.isConnected?n("h3",[e._v("We're connected to the server!")]):e._e(),n("div",{staticClass:"model-container"},e._l(this.$store.state.models,function(e){return n("model",{key:e.id,attrs:{model_id:e.id,name:e.name}})}),1),n("div",{staticClass:"controls"},[n("md-button",{staticClass:"md-raised",on:{click:function(t){return e.recordStop()}}},[e._v(e._s(e.recordButtonText))]),n("md-button",{staticClass:"md-raised",on:{click:function(t){return e.playAudio()}}},[e._v("Play")]),n("md-button",{staticClass:"md-raised",on:{click:function(t){return e.transcribe()}}},[e._v("Transcribe")])],1)])},f=[],m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"Model"},[n("h1",[e._v(e._s(e.name))]),n("p",[e._v(e._s(e.socketMessage))])])},h=[],v={name:"Model",props:["name","model_id"],data(){return{isConnected:!1,socketMessage:"This is a transcription.",recordButtonText:"Record"}},sockets:{connect(){this.isConnected=!0},disconnect(){this.isConnected=!1},transcription(e){this.socketMessage=e[this.model_id]}},methods:{}},b=v,_=(n("c598"),Object(i["a"])(b,m,h,!1,null,"37527437",null)),g=_.exports;let y=null,M=null;const w=()=>new Promise(async e=>{const t=await navigator.mediaDevices.getUserMedia({audio:!0}),n=new MediaRecorder(t,{mimeType:"audio/webm; codecs=opus"});y=[],n.addEventListener("dataavailable",e=>{y.push(e.data)});const o=()=>n.start(),s=()=>new Promise(e=>{n.addEventListener("stop",()=>{M=new Blob(y,{type:"audio/wav;"});const t=URL.createObjectURL(M),n=new Audio(t),o=()=>n.play();e({audioBlob:M,audioUrl:t,play:o})}),n.stop()});e({start:o,stop:s})});let k=null,C=null;var O={name:"Transcriptor",components:{model:g},data(){return{isConnected:!1,socketMessage:"",recordButtonText:"Record"}},sockets:{connect(){this.isConnected=!0},disconnect(){this.isConnected=!1},transcription(e){this.socketMessage=e}},methods:{async recordStop(){k?(C=await k.stop(),k=null,this.socketMessage="",this.recordButtonText="Record"):(k=await w(),k.start(),this.recordButtonText="Stop")},async playAudio(){C&&"function"===typeof C.play&&C.play()},async transcribe(){C&&"function"===typeof C.play&&this.$socket.emit("record",M,this.$store.getters.getPickedModels.map(e=>e["id"]))}}},S=O,x=(n("9d66"),Object(i["a"])(S,p,f,!1,null,"a92d0c50",null)),j=x.exports,T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ModelSelector"},[n("div",[n("md-field",{staticClass:"select"},[n("label",{attrs:{for:"model"}},[e._v("ModelSelector")]),n("md-select",{attrs:{id:"model"},model:{value:e.chosenModel,callback:function(t){e.chosenModel=t},expression:"chosenModel"}},e._l(e.models,function(t,o,s){return n("md-option",{key:o,attrs:{value:o}},[e._v(e._s(t)+"\n                ")])}),1)],1)],1),n("div",{staticClass:"controls"},[n("md-button",{staticClass:"md-raised md-primary",on:{click:function(t){return e.add(e.chosenModel)}}},[e._v("Add")]),n("md-button",{staticClass:"md-raised md-accent",on:{click:e.cancel}},[e._v("Cancel")])],1)])},P=[],$=n("bc3a"),A=n.n($),R={name:"ModelSelector",data(){return{models:null,chosenModel:null}},mounted(){var e=this;A.a.get(H+"/get_models").then(t=>{console.log("Models received from server: ",t.data),e.models=t.data,e.chosenModel=t.data[0]}).catch(e=>{console.log("ERROR IN AXIOS",e)})},sockets:{connect(){this.isConnected=!0},disconnect(){this.isConnected=!1},transcription(e){this.socketMessage=e}},methods:{add(e){this.$store.commit("addModel",{id:e,name:this.models[e]}),this.$router.push("/")},cancel(){this.$router.push("/")}}},E=R,B=(n("46d4"),Object(i["a"])(E,T,P,!1,null,"5db034ea",null)),L=B.exports;o["default"].use(u["a"]);var U=new u["a"]({routes:[{path:"/",name:"Transcriptor",component:j},{path:"/add",name:"ModelSelector",component:L}]}),I=n("2f62"),J=(n("94d5"),n("63e0"));o["default"].use(I["a"]);const N={models:[]};var D=new I["a"].Store({state:N,getters:{getPickedModels:e=>{return e.models}},actions:J,mutations:{addModel(e,t){e.models.push(t)}}}),W=n("8055"),X=n.n(W),q=n("5132"),z=n.n(q),F=n("43f9"),G=n.n(F);n("51de"),n("e094");n.d(t,"ServerAddress",function(){return H}),n.d(t,"SocketInstance",function(){return K}),o["default"].config.productionTip=!1;const H=window.location.protocol+"//"+window.location.hostname+":5000",K=X()(H,{secure:!0});o["default"].use(G.a),o["default"].use(new z.a({debug:!0,connection:K})),new o["default"]({router:U,store:D,render:e=>e(l),components:{App:l},template:"<App/>"}).$mount("#app")},"63e0":function(e,t){},"94d5":function(e,t){},"9d66":function(e,t,n){"use strict";var o=n("f109"),s=n.n(o);s.a},c598:function(e,t,n){"use strict";var o=n("d885"),s=n.n(o);s.a},d885:function(e,t,n){},f109:function(e,t,n){}});
//# sourceMappingURL=app.ecaf705c.js.map